
<!-- Movie title will be place here. Probably wrapped in header tags. Will be able to display the title when information is parsed from OMDB API -->
<h1 class= "center"><%= @movie.Title %></h1>

<!-- This is the section for individual movie information. The parsed data should be able to be place into each li element once the response attributes are finalized.-->
<section class= "center", id="movie-info">
  <img src="<%= @movie.Poster %>" style="height:80%;width:60%;display:inline-block;">
  <ul style="display:inline-block;width:30%;vertical-align:top;">
    <h2><%= @movie.Title %></h2>
    <li><%= @movie.Year %></li>
    <li><em>Released:</em> <%= @movie.Released %></li>
    <li><em>Runtime:</em><%= @movie.Runtime %></li>
    <li><em>Genre:</em><%= @movie.Genre %></li>
    <li><em>Director:</em><%= @movie.Director %></li>
    <li><em>Writer:</em><%= @movie.Writer %></li>
    <li><em>Actors:</em><%= @movie.Actors %></li>
    <li><em>Language:</em><%= @movie.Language %></li>
    <li><em>Country:</em><%= @movie.Country %></li>
    <li><em>Awards:</em><%= @movie.Awards %></li>
    <li><em>Year:</em><%= @movie.Year %></li>
    <li><em>Metascore:</em><%= @movie.Metascore %></li>
    <li><em>IMDB Rating:</em><%= @movie.imdbRating %></li>
    <li><em>IMDB Votes:</em><%= @movie.imdbVotes %></li>
  </ul>



  <h4>Likes : <%= @movie.likes.count %></h4>
</section>
<section id="related-movie-container container">

  <div style="display:flex;flex-direction:row;justify-content:center;width:98%;">
    <% if @related_movies %>
    <ul>
      <% @related_movies.each do |movie| %>
      <li style="display:inline-block;"><%= link_to image_tag(movie.Poster, size: '140x200'), movie %></li>
      <% end %>
    </ul>
    <% end %>
  </div>
</section>

<section id="like-movie-form">
  <% if logged_in? %>
    <%= form_tag("/movies/#{@movie.id}/like", method: "post") do %>
      <%= submit_tag("&#128077;".html_safe) %>
    <% end %>
  <% end %>
</section>


<section>
  <% if @errors %>
    <% @errors.each do |err| %>
      <%=err %>
    <% end %>
  <% end %>
  <% if logged_in? %>
    <%= form_tag("/watchlists", method: "post") do %>
      <%= hidden_field_tag("user_id", current_user.id) %>
      <%= hidden_field_tag("imdbID", @movie.imdbID) %>
      <%= hidden_field_tag("movie_title", @movie.Title) %>
      <%= submit_tag("Add movie to your watchlist") %>
    <% end %>
    <% else %>
      <%= "You need to be logged in to save movies to your watch list." %>
  <% end %>
</section>


<!-- This is going to be the section where conversations on the movie are going to be placed. Almost certain we'll be iterating through the conversations stored in our database for the topics that get displayed here. Will be creating a helper method to pull the info we need from our database to display to the user.-->
<section id="converstaions">
  <div style="text-align:center;">

  <h3>Comments:</h3>
  <%if @comments%>
    <% @comments.each do |comment|%>
      <p><%=comment.content%></p>
      <p><%=comment.user.name%></p>
      <p><%=comment.created_at.to_datetime.in_time_zone("Central Time (US & Canada)").strftime("%A, %d %b %Y")%></p>
      <% if comment.user_id == current_user.id %>
      <%= link_to 'Delete', comment_path(comment), method: :delete %>
      <%end%>
    <%end%>
  <%end%>

  <%= form_for @comment do |f| %>
    <%= f.hidden_field :user_id, value: current_user.id %>
    <%= f.hidden_field :movie_id, value: @movie.id %>
    <%= f.label "Comment" %>
    <%= f.text_area :content %><br>
    <%= f.submit  "Post" %>
  <%end%>


 </div>

</section>
